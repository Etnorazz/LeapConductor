from lib import Leap
import sys 

def main(): 
    listener = StopTrackListener() 
    controller = Leap.Controller(listener) 

    print "Press Enter to quit" 
    sys.stdin.readline() 

    controller = None


class StopTrackListener(Leap.Listener): 

    def onInit(self, controller): 
        self.alpha = 0.25
        self.track_stop = 70
        self.filtered_radius = 100
        self.filtered_derivative = 0
        self.previous_timestamp = 0 
        self.previous_radius = 0

    def onFrame(self, controller): 
        frame = controller.frame()
        hand = frame.hands()
        numHands = len(hand)

        if numHands >= 1: 
            hand = hand[0]
            ball = hand.ball() 
            if ball is not None: 
                current_derivative = ball.radius - self.previous_radius
                dt = self.previous_timestamp - frame.timestamp()
                self.filtered_derivative = (1-self.alpha)*self.filtered_derivative + self.alpha*current_derivative
                print self.filtered_derivative
main()
